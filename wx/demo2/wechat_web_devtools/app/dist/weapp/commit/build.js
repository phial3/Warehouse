"use strict";function init(){var e="darwin"===process.platform,i=global.appConfig.isDev,r=require("fs"),n=require("path"),o=require("../utils/tools.js"),t=require("glob"),c=require("async"),s=require("../../config/dirConfig.js"),a=s.WeappVendor,p=require("mkdir-p"),u=require("./initAppConfig.js"),l=require("./initAppServiceJs.js"),f=i?n.join(__dirname,"../vendor/"):a,d=(e?n.join(f,"wcc"):n.join(f,"wcc.exe"),require("child_process").spawn,require("../../common/log/log.js")),j=require("babel-core"),v=s.Weappdest,m=o.whiteFileExtName;_exports=function(e,i,o){var s=(e.projectpath,e.es6),a=e.minified,f=n.join(v,""+ +new Date);p.sync(f);var g={};g.appconfig=function(r){u(e,i,function(e,i){r(e,i)})},g.appservicejs=function(r){l(e,i,function(e,i){r(e,i)})},c.parallel(g,function(i,c){return i?void o(i.toString()):void t("./**",{nodir:!0,cwd:e.projectpath,ignore:["./node_modules/**/*"]},function(i,t){for(var c=0;c<t.length;c++){var u=t[c],l=n.extname(u);if(m[l]){var v=n.join(f,u),g=n.dirname(v);if(p.sync(g),s&&".js"===l){var q=r.readFileSync(n.join(e.projectpath,u),"utf8");try{var h=j.transform(q,{presets:["es2015"],babelrc:!1,minified:a,comments:!a});r.writeFileSync(v,h.code)}catch(w){return void o(w)}}else{var y=r.readFileSync(n.join(e.projectpath,u));r.writeFileSync(v,y)}}else d.info("build.js find file not in whiteList "+u)}o(null,f)})})}}var _exports;init(),module.exports=_exports;