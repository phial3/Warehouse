"use strict";function init(){function e(e,n){return"\n      <script>"+f[e.hash]+'</script>\n      <script>\n        document.dispatchEvent(new CustomEvent("generateFuncReady", {\n          detail: {\n            generateFunc: $gwx(\'./'+n+"')\n          }\n        }))\n      </script>\n    "}var n=global.appConfig.isDev,t="darwin"===process.platform,r=(require("fs"),require("path")),i=require("../../config/dirConfig.js"),o=i.WeappVendor,c=require("../utils/tools.js"),s=require("../utils/projectManager.js"),a=n?r.join(__dirname,"../vendor/"):o,u=t?r.join(a,"wcc"):r.join(a,"wcc.exe"),p=(require("glob"),require("child_process").spawn),l=require("../../config/config.js"),g=l.WXML_ERROR,f={};s.manager.on("FILE_CHANGE",function(e,n,t){".wxml"===r.extname(t)&&delete f[e.hash]}),_exports=function(n,t,i){var o=t.project,a=c.getFilePath(n,o),l=r.relative(o.projectpath,a),d="",h="";return f[o.hash]?void process.nextTick(function(){i(null,{generateFunc:e(o,l.replace(/\\/g,"/")),styleStr:d})}):void s.getAllWXMLFileList(o,function(n,t){n?i(n.toString()):!function(){var n=t,r=p(u,n,{cwd:o.projectpath}),c=[],s=[];r.on("close",function(n){if(0===n)f[o.hash]=Buffer.concat(c).toString(),h=e(o,l.replace(/\\/g,"/")),i(null,{generateFunc:h,styleStr:d});else{var t=Buffer.concat(s).toString();i({type:g,msgForConsole:t,msg:"编译.wxml 文件错误， 错误信息："+t+"，可在控制台查看更详细信息"})}}),r.stdout.on("data",function(e){c.push(e)}),r.stderr.on("data",function(e){s.push(e)})}()})}}var _exports;init(),module.exports=_exports;