"use strict";function init(){var t=require("../lib/react.js"),e=require("../actions/windowActions.js"),i=require("../stores/windowStores.js"),o=require("../stores/webviewStores.js"),n=require("../stores/projectStores.js"),s=(require("../actions/projectActions.js"),require("../common/log/log.js")),r=require("./setting/setting.js"),a=require("./lunch/lunch.js"),c=require("./create/create.js"),l=require("./confirm/confirm.js"),p=require("./toast/toast.js"),h=require("./Main.js"),g=require("../utils/newReport.js"),m=require("../config/config.js"),u=m.SELECT_URL_TYPE,j=m.SELECT_UNKNOW_TYPE,S={},f=function(t){e.showTipsMsg({msg:t,type:"error"})},w=t.createClass({displayName:"ContainController",getInitialState:function(){var t=!!Object.keys(i.getUserInfo()).length,e=n.getLastSelect(),o=e===u,s="",r=!1;return e!==u&&e!==j&&(s=e),{hasLogin:t,commonUrl:o,project:s,type:e,showSetting:r}},goToLogin:function(){this.setState({hasLogin:!1,commonUrl:!1,project:""}),global.Win.restore()},componentDidMount:function(){var t=this;this.state.hasLogin&&(this.state.project||this.state.commonUrl)&&global.Win.maximize(),global.Win.on("maximize",function(){S={maxHeight:global.Win.height,maxWidth:global.Win.width}}),i.on("UPDATA_USER_INFO",function(e){var i=!!Object.keys(e).length;i?(t.setState({hasLogin:!0}),(t.state.project||t.state.commonUrl)&&global.Win.maximize()):setTimeout(function(){t.goToLogin()},50)}),o.on("NOT_LOGIN",this.goToLogin),o.on("INVALID_LOGIN",this.goToLogin),n.on("CLOSE_PROJECT",function(){t.setState({project:"",commonUrl:""}),global.Win.restore()}),n.on("DEL_PROJECT",function(){t.setState({project:"",commonUrl:""}),global.Win.restore()}),i.on("SHOW_SETTING",this._showSetting)},componentWillUnmount:function(){i.removeListener("SHOW_SETTING",this._showSetting)},handleOnClick:function(t){e.bodyClick(t)},appQuit:function(){s.info("ContainController.js exit"),nw.App.quit()},appMax:function(){global.Win.width!==S.maxWidth||global.Win.height!==S.maxHeight?global.Win.maximize():global.Win.restore()},appMin:function(){global.Win.minimize()},goMain:function(t){var e=this;t?n.setProjectConfig(t,function(i){return i?void f(i):(e.setState({commonUrl:!1,project:t,type:t}),n.setProjectType(t.hash),void global.Win.maximize())}):(this.setState({commonUrl:!0,project:"",type:u}),n.setProjectType(u),global.Win.maximize());t?g("project_open",t.appid):g("url_open")},_showSetting:function(){this.setState({showSetting:!this.state.showSetting})},render:function(){var e=void 0;return e=this.state.hasLogin?this.state.commonUrl||this.state.project?t.createElement(h,{project:this.state.project,appQuit:this.appQuit,appMax:this.appMax,appMin:this.appMin}):t.createElement(c,{appQuit:this.appQuit,goMain:this.goMain,type:this.state.type}):t.createElement(a,{appQuit:this.appQuit}),t.createElement("div",{onClick:this.handleOnClick},e,t.createElement(r,{show:this.state.showSetting,showSetting:this._showSetting}),t.createElement(p,null),t.createElement(l,null))}});_exports=w}var _exports;init(),module.exports=_exports;
