"use strict";function init(){function e(e){var t=document.createElement("input");t.style.display="none",t.setAttribute("type","file"),e.accept&&t.setAttribute("accept",e.accept),e.multiple&&t.setAttribute("multiple","multiple"),global.contentDocumentBody.appendChild(t),t.addEventListener("change",function(o){e.sucCall&&e.sucCall(o),global.contentDocumentBody.removeChild(t)}),t.addEventListener("cancel",function(o){e.cancelCall&&e.cancelCall(o),global.contentDocumentBody.removeChild(t)}),t.click()}function t(e,t){u.sendASSDK("previewImage",e,t)}function o(t,o){var a=t.args,i=Number.isInteger(a.count)&&a.count<=9&&a.count>=1?a.count:9;e({accept:"image/*",multiple:i>1,sucCall:function(e){var a=r.getProjectByHash(t.apphash),s=e.target.value.split(";");s=s.slice(0,i);var l=[];s.forEach(function(e){var t=n.extname(e);l.push(c.copyFileToTemp(e,a.hash,t))}),o({errMsg:"chooseImage:ok",tempFilePaths:l})},cancelCall:function(){o({errMsg:"chooseImage:cancel"})}})}function a(t,o){t.args;e({accept:"video/*",sucCall:function(e){var a=r.getProjectByHash(t.apphash),i=e.target.value.split(";"),s=[];i.forEach(function(e){var t=n.extname(e);s.push(c.copyFileToTemp(e,a.hash,t))}),o({errMsg:"chooseVideo:ok",tempFilePath:s[0]})},cancelCall:function(){o({errMsg:"chooseVideo:cancel"})}})}function i(e,t){var o=e.args.src,a=c.isAppTmpPath(o),i=r.getProjectByHash(e.apphash),u=a?c.getRealPath(o):n.join(i.projectpath,o);if(!l.existsSync(u))return void t({errMsg:"getImageInfo:fail, file not exist"});var p=l.createReadStream(u);s(p,function(e,o){t(e?{errMsg:"getImageInfo:fail, "+e.toString()}:{errMsg:"getImageInfo:ok",width:o.width,height:o.height})})}var r=(require("../../utils/tools.js"),require("../../stores/projectStores.js")),c=require("../../utils/file.js"),n=require("path"),s=(require("url"),require("../../lib/imagesize.js")),l=require("fs"),u=(require("../../common/request/request.js"),require("../../weapp/utils/tools.js"),require("../../actions/webviewActions.js"));_exports={chooseVideo:a,chooseImage:o,previewImage:t,getImageInfo:i}}var _exports;init(),module.exports=_exports;